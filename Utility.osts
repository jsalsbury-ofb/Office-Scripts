{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook) {\n\n    const selected = workbook.getSelectedRange()\n    console.log(Utility.GetColumnAddressByName(workbook.getActiveWorksheet(), \"constituent\", Case.Insensitive))\n\n}\n\nclass Utility {\n\n    /**\n     * An object containing pre-defined colors from the Material UI \n     * palette, which is open-source under the MIT license.\n     * The full palette can be viewed at: https://mui.com/material-ui/customization/color/\n     */\n    static readonly Colors = {\n        SUCCESS: \"#c8e6c9\",\n        WARNING: \"#fff9c4\",\n        ERROR: \"#ffcdd2\",\n        INFO: \"#bbdefb\",\n        IGNORE: \"#f5f5f5\",\n        ALERT: \"#ffa726\",\n        RED: {\n            50: \"#ffebee\",\n            100: \"#ffcdd2\",\n            200: \"#ef9a9a\",\n            300: \"#e57373\",\n            400: \"#ef5350\",\n            500: \"#f44336\",\n            600: \"#e53935\",\n            700: \"#d32f2f\",\n            800: \"#c62828\",\n            900: \"#b71c1c\",\n            a100: \"#ff8a80\",\n            a200: \"#ff5252\",\n            a400: \"#ff1744\",\n            a700: \"#d50000\"\n        },\n        PINK: {\n            50: \"#fce4ec\",\n            100: \"#f8bbd0\",\n            200: \"#f48fb1\",\n            300: \"#f06292\",\n            400: \"#ec407a\",\n            500: \"#e91e63\",\n            600: \"#d81b60\",\n            700: \"#c2185b\",\n            800: \"#ad1457\",\n            900: \"#880e4f\",\n            a100: \"#ff80ab\",\n            a200: \"#ff4081\",\n            a400: \"#f50057\",\n            a700: \"#c51162\"\n        },\n        PURPLE: {\n            50: \"#f3e5f5\",\n            100: \"#e1bee7\",\n            200: \"#ce93d8\",\n            300: \"#ba68c8\",\n            400: \"#ab47bc\",\n            500: \"#9c27b0\",\n            600: \"#8e24aa\",\n            700: \"#7b1fa2\",\n            800: \"#6a1b9a\",\n            900: \"#4a148c\",\n            a100: \"#ea80fc\",\n            a200: \"#e040fb\",\n            a400: \"#d500f9\",\n            a700: \"#aa00ff\"\n        },\n        DEEPPURPLE: {\n            50: \"#ede7f6\",\n            100: \"#d1c4e9\",\n            200: \"#b39ddb\",\n            300: \"#9575cd\",\n            400: \"#7e57c2\",\n            500: \"#673ab7\",\n            600: \"#5e35b1\",\n            700: \"#512da8\",\n            800: \"#4527a0\",\n            900: \"#311b92\",\n            a100: \"#b388ff\",\n            a200: \"#7c4dff\",\n            a400: \"#651fff\",\n            a700: \"#6200ea\"\n        },\n        INDIGO: {\n            50: \"#e8eaf6\",\n            100: \"#c5cae9\",\n            200: \"#9fa8da\",\n            300: \"#7986cb\",\n            400: \"#5c6bc0\",\n            500: \"#3f51b5\",\n            600: \"#3949ab\",\n            700: \"#303f9f\",\n            800: \"#283593\",\n            900: \"#1a237e\",\n            a100: \"#8c9eff\",\n            a200: \"#536dfe\",\n            a400: \"#3d5afe\",\n            a700: \"#304ffe\"\n        },\n        BLUE: {\n            50: \"#e3f2fd\",\n            100: \"#bbdefb\",\n            200: \"#90caf9\",\n            300: \"#64b5f6\",\n            400: \"#42a5f5\",\n            500: \"#2196f3\",\n            600: \"#1e88e5\",\n            700: \"#1976d2\",\n            800: \"#1565c0\",\n            900: \"#0d47a1\",\n            a100: \"#82b1ff\",\n            a200: \"#448aff\",\n            a400: \"#2979ff\",\n            a700: \"#2962ff\"\n        },\n        LIGHTBLUE: {\n            50: \"#e1f5fe\",\n            100: \"#b3e5fc\",\n            200: \"#81d4fa\",\n            300: \"#4fc3f7\",\n            400: \"#29b6f6\",\n            500: \"#03a9f4\",\n            600: \"#039be5\",\n            700: \"#0288d1\",\n            800: \"#0277bd\",\n            900: \"#01579b\",\n            a100: \"#80d8ff\",\n            a200: \"#40c4ff\",\n            a400: \"#00b0ff\",\n            a700: \"#0091ea\"\n        },\n        CYAN: {\n            50: \"#e0f7fa\",\n            100: \"#b2ebf2\",\n            200: \"#80deea\",\n            300: \"#4dd0e1\",\n            400: \"#26c6da\",\n            500: \"#00bcd4\",\n            600: \"#00acc1\",\n            700: \"#0097a7\",\n            800: \"#00838f\",\n            900: \"#006064\",\n            a100: \"#84ffff\",\n            a200: \"#18ffff\",\n            a400: \"#00e5ff\",\n            a700: \"#00b8d4\"\n        },\n        TEAL: {\n            50: \"#e0f2f1\",\n            100: \"#b2dfdb\",\n            200: \"#80cbc4\",\n            300: \"#4db6ac\",\n            400: \"#26a69a\",\n            500: \"#009688\",\n            600: \"#00897b\",\n            700: \"#00796b\",\n            800: \"#00695c\",\n            900: \"#004d40\",\n            a100: \"#a7ffeb\",\n            a200: \"#64ffda\",\n            a400: \"#1de9b6\",\n            a700: \"#00bfa5\"\n        },\n        GREEN: {\n            50: \"#e8f5e9\",\n            100: \"#c8e6c9\",\n            200: \"#a5d6a7\",\n            300: \"#81c784\",\n            400: \"#66bb6a\",\n            500: \"#4caf50\",\n            600: \"#43a047\",\n            700: \"#388e3c\",\n            800: \"#2e7d32\",\n            900: \"#1b5e20\",\n            a100: \"#b9f6ca\",\n            a200: \"#69f0ae\",\n            a400: \"#00e676\",\n            a700: \"#00c853\"\n        },\n        LIGHTGREEN: {\n            50: \"#f1f8e9\",\n            100: \"#dcedc8\",\n            200: \"#c5e1a5\",\n            300: \"#aed581\",\n            400: \"#9ccc65\",\n            500: \"#8bc34a\",\n            600: \"#7cb342\",\n            700: \"#689f38\",\n            800: \"#558b2f\",\n            900: \"#33691e\",\n            a100: \"#ccff90\",\n            a200: \"#b2ff59\",\n            a400: \"#76ff03\",\n            a700: \"#64dd17\"\n        },\n        LIME: {\n            50: \"#f9fbe7\",\n            100: \"#f0f4c3\",\n            200: \"#e6ee9c\",\n            300: \"#dce775\",\n            400: \"#d4e157\",\n            500: \"#cddc39\",\n            600: \"#c0ca33\",\n            700: \"#afb42b\",\n            800: \"#9e9d24\",\n            900: \"#827717\",\n            a100: \"#f4ff81\",\n            a200: \"#eeff41\",\n            a400: \"#c6ff00\",\n            a700: \"#aeea00\"\n        },\n        YELLOW: {\n            50: \"#fffde7\",\n            100: \"#fff9c4\",\n            200: \"#fff59d\",\n            300: \"#fff176\",\n            400: \"#ffee58\",\n            500: \"#ffeb3b\",\n            600: \"#fdd835\",\n            700: \"#fbc02d\",\n            800: \"#f9a825\",\n            900: \"#f57f17\",\n            a100: \"#ffff8d\",\n            a200: \"#ffff00\",\n            a400: \"#ffea00\",\n            a700: \"#ffd600\"\n        },\n        AMBER: {\n            50: \"#fff8e1\",\n            100: \"#ffecb3\",\n            200: \"#ffe082\",\n            300: \"#ffd54f\",\n            400: \"#ffca28\",\n            500: \"#ffc107\",\n            600: \"#ffb300\",\n            700: \"#ffa000\",\n            800: \"#ff8f00\",\n            900: \"#ff6f00\",\n            a100: \"#ffe57f\",\n            a200: \"#ffd740\",\n            a400: \"#ffc400\",\n            a700: \"#ffab00\"\n        },\n        ORANGE: {\n            50: \"#fff3e0\",\n            100: \"#ffe0b2\",\n            200: \"#ffcc80\",\n            300: \"#ffb74d\",\n            400: \"#ffa726\",\n            500: \"#ff9800\",\n            600: \"#fb8c00\",\n            700: \"#f57c00\",\n            800: \"#ef6c00\",\n            900: \"#e65100\",\n            a100: \"#ffd180\",\n            a200: \"#ffab40\",\n            a400: \"#ff9100\",\n            a700: \"#ff6d00\"\n        },\n        DEEPORANGE: {\n            50: \"#fbe9e7\",\n            100: \"#ffccbc\",\n            200: \"#ffab91\",\n            300: \"#ff8a65\",\n            400: \"#ff7043\",\n            500: \"#ff5722\",\n            600: \"#f4511e\",\n            700: \"#e64a19\",\n            800: \"#d84315\",\n            900: \"#bf360c\",\n            a100: \"#ff9e80\",\n            a200: \"#ff6e40\",\n            a400: \"#ff3d00\",\n            a700: \"#dd2c00\"\n        },\n        BROWN: {\n            50: \"#efebe9\",\n            100: \"#d7ccc8\",\n            200: \"#bcaaa4\",\n            300: \"#a1887f\",\n            400: \"#8d6e63\",\n            500: \"#795548\",\n            600: \"#6d4c41\",\n            700: \"#5d4037\",\n            800: \"#4e342e\",\n            900: \"#3e2723\"\n        },\n        GREY: {\n            50: \"#fafafa\",\n            100: \"#f5f5f5\",\n            200: \"#eeeeee\",\n            300: \"#e0e0e0\",\n            400: \"#bdbdbd\",\n            500: \"#9e9e9e\",\n            600: \"#757575\",\n            700: \"#616161\",\n            800: \"#424242\",\n            900: \"#212121\"\n        },\n        BLUEGREY: {\n            50: \"#eceff1\",\n            100: \"#cfd8dc\",\n            200: \"#b0bec5\",\n            300: \"#90a4ae\",\n            400: \"#78909c\",\n            500: \"#607d8b\",\n            600: \"#546e7a\",\n            700: \"#455a64\",\n            800: \"#37474f\",\n            900: \"#263238\"\n        }\n    }\n\n    /**\n     * Fills a range with a specified color.\n     * \n     * @param range The range to highlight.\n     * @param color The color to highlight the range with.\n     */\n    public static Highlight(range: ExcelScript.Range, color: string) {\n        range.getFormat().getFill().setColor(color)\n    }\n\n    /**\n     * Determines if a range is empty.\n     * \n     * @param range The range to evaluate.\n     * @returns `true` if the range is empty and `false` otherwise.\n     */\n    public static IsEmpty(range: ExcelScript.Range): boolean {\n\n        const values: ExcelScript.RangeValueType[][] = range.getValueTypes()\n\n        for (const row of values) {\n            for (const cell of row) {\n                if (cell !== ExcelScript.RangeValueType.empty) return false\n            }\n        }\n\n        return true\n\n    }\n\n    /**\n     * Determines if a range is not empty.\n     * \n     * @param range The range to evaluate.\n     * @returns `true` if the range is not empty and `false` otherwise.\n     */\n    public static IsNotEmpty(range: ExcelScript.Range): boolean {\n        return !Utility.IsEmpty(range)\n    }\n\n    /**\n     * Determines if a range contains a substring.\n     * \n     * @param range The range to evaluate.\n     * @param substring The substring to search for.\n     */\n    public static Contains(\n        range: ExcelScript.Range, \n        substring: string,\n        mode: Case = Case.Sensitive\n    ): boolean {\n\n        const values: (string | number | boolean)[][] = range.getValues()\n\n        for (const row of values) {\n            for (const cell of row) {\n                let value: string = cell.toString()\n                if (mode === Case.Insensitive) {\n                    value = value.toLowerCase()\n                    substring = substring.toLowerCase()\n                }\n                if (value.includes(substring)) {\n                    return true\n                }\n            }\n        }\n\n        return false\n\n    }\n\n    /**\n     * Locates the first instance of a search key in a range and returns the address, if found.\n     * \n     * @param range The range to search.\n     * @param searchKey The value to search for.\n     * @param mode The search mode. Case sensitive by default.\n     * @returns The string address of the first match, if found.\n     * @throws RangeError if a match is not found.\n     */\n    public static Locate(\n        range: ExcelScript.Range, \n        searchKey: string | number | boolean, \n        mode: Case = Case.Sensitive\n    ): string {\n\n        if (mode === Case.Insensitive && typeof searchKey === \"string\") {\n            searchKey = searchKey.toLowerCase()\n        }\n\n        const values: (string | number | boolean)[][] = range.getValues()\n\n        for (let rowIndex = 0; rowIndex < values.length; rowIndex++) {\n            for (let columnIndex = 0; columnIndex < values[rowIndex].length; columnIndex++) {\n                let value = values[rowIndex][columnIndex]\n                if (mode === Case.Insensitive && typeof value === \"string\") {\n                    value = value.toLowerCase()\n                }\n                if (value === searchKey) {\n                    return range.getCell(rowIndex, columnIndex).getAddress()\n                }\n            }\n        }\n\n        throw new RangeError(`Value of \"${searchKey} not found in range.`)\n        \n    }\n\n    /**\n     * Returns the address of a column whose first row value matches the name parameter, if found.\n     * \n     * @param worksheet The worksheet to search.\n     * @param name The name of the column to search for.\n     * @param mode Optional parameter search mode. Case sensitive by default.\n     * @returns The address of the matching header cell, if found.\n     * @throws RangeError if not found.\n     */\n    public static GetColumnAddressByName(\n        worksheet: ExcelScript.Worksheet, \n        name: string,\n        mode: Case = Case.Sensitive\n    ): string {\n        return this.Locate(this.GetHeaderRow(worksheet), name, mode)\n    }\n    \n    /**\n     * \n     */\n    public static GetHeaderRow(worksheet: ExcelScript.Worksheet): ExcelScript.Range {\n        return worksheet.getUsedRange().getRow(0)\n    }\n\n}\n\nenum Case {\n    Sensitive,\n    Insensitive\n}","description":"","noCodeMetadata":"","parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}